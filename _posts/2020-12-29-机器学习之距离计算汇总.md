---
layout:     post
title:      机器学习篇 | 机器学习常见距离汇总
subtitle:   
date:       2020-12-29
author:     Aiden
header-img: img/post-bg-coffee.jpeg
catalog: true 			
tags:								
    - 机器学习
---

对函数 `dist(.,.)`, 若它是一个"距离度量", 则需要满足一些基本性质 : 

- **非负性** : $dist(x_i, x_j) \geq 0$
- **同一性** : $dist(x_i, x_j) = 0$ 当且仅当 $x_i = x_j$
- **对称性** : $dist(x_i, x_j) = dist(x_j, x_i)$
- **直递性** : $dist(x_i, x_j) \leq dist(x_i, x_k) + dist(x_k, x_j)$

需要注意的是, 通常我们是基于某种形式的距离来定义"相似度度量",  距离越大， 相似度越小, 然而用于相似度度量的距离未必一定要满足距离度量的所有基本性质, 尤其是直递性。

对于给定样本 $x_{i} = (x_{i1}; x_{i2}; ...; x_{in})$ 与 $x_{j} = (x_{j1}; x_{j2}; ...; x_{jn})$


### 闵可夫斯基距离

闵可夫斯基距离是一种比较常见的用户相似度的计算方式

$$dist_{mk}(x_{i}, x_{j}) = (\sum_{u=1}^{n}|x_{iu} - x_{ju}|^{p})^{\frac{1}{p}}$$

#### 曼哈顿距离

对于闵可夫斯基距离, 当 `p=1` 时, 表示**曼哈顿距离** 

$$dist_{man}(x_{i}, x_{j}) = \begin{Vmatrix} x_{i} - x_{j} \end{Vmatrix}_{1} = \sum_{u=1}^{n} |x_{iu} - x_{ju}|$$

#### 欧氏距离

对于闵可夫斯基距离， 当 `p=2` 时， 表示 **欧氏距离**

$$dist_{ed}(x_{i}, x_{j}) = \begin{Vmatrix} x_{i} - x_{j} \end{Vmatrix}_{2} = (\sum_{u=1}^{n} |x_{iu} - x_{ju}|^{2})^{\frac{1}{2}}$$

#### 切比雪夫距离

对于闵可夫斯基距离, 当 `$p \rightarrow \infty$` 时, 表示 **切比雪夫距离**

$$dist_{che}(x_{i}, x_{j}) = \begin{Vmatrix} x_{i} - x_{j} \end{Vmatrix}_{\infty} = \lim_{p \rightarrow \infty} (\sum_{u=1}^{n} |x_{iu} - x_{ju}|^{2})^{\frac{1}{\infty}} = max_{u=1}^{n}|x_{iu} - x_{ju}|$$



> 闵可夫斯基距离存在的问题

1. 将各个分量的量纲， 当做相同的权重来看待
2. 没有考虑各个分量的分布,期望，方差等可能是不同的

### 标准化欧氏距离

对于数据各维度分量的分布不一致的情况， 可以将分量都标准化到**均值**,**方差**都相等的情况

假设样本集$X$的数学期望或均值为`M`, 
标准差为 `S`. 那么 $X$ 的标准化变量$X^{*}$表示为 : 

$$X^{*} = \frac{X - M}{S}$$

**标准化后， 数学期望为0, 方差为1**

### 马氏距离

欧氏距离的一种修正, 又花了欧氏距离中各个维度尺度不一致且相关的问题。

单个数据点的马氏距离 : 

$$D_{m}(x_{i}) = \sqrt{(x_{i} - \mu)^{T}S^{-1}(x_{i} - \mu)}$$

数据点之间的马氏距离 : 

$$D_{m}(x_{i}, x_{j}) = \sqrt{(x_{i} - x_{j})^{T}S^{-1}(x_{i} - x_{j})}$$

其中, $S$ 是多维随机变量 $X$ 的协方差矩阵, $\mu$ 为样本均值, 如果协方差矩阵是单位向量, 也就是各维度独立分布, 马氏距离就变成欧氏距离。


---

> 参考内容 : 

- 周志华 - 机器学习
- [机器学习总结之——各种距离汇总](https://blog.csdn.net/weixin_42715356/article/details/82845376)
- [马氏距离](https://zhuanlan.zhihu.com/p/46626607)
- [协方差矩阵](https://zhuanlan.zhihu.com/p/37609917)